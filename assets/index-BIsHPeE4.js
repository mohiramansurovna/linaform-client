import{j as E,R as F,r,d as K}from"./index-Coke0nAI.js";import{a as oe,u as k,b as $}from"./createLucideIcon-CNxtfhBc.js";import{c as B,k as ne,e as N,j as re,b as se}from"./sidebar-BzK-oMkL.js";import{P as q}from"./index-DzwLIVv3.js";import{u as L}from"./useAuthStore-C2RerLba.js";import"./schemas-DHehp46N.js";import{u as G}from"./useMutation-CCGNJDG7.js";import{c as ce}from"./react-qWK4YXkQ.js";import{M as ie,i as ae,u as Q,P as ue,a as le,b as fe,L as de}from"./proxy-BUDMGJGh.js";function Ge({className:e,...n}){return E.jsx("div",{"data-slot":"skeleton",className:oe("bg-accent animate-pulse rounded-md",e),...n})}function pe(e){const n=e+"CollectionProvider",[o,t]=B(n),[d,c]=o(n,{collectionRef:{current:null},itemMap:new Map}),I=a=>{const{scope:s,children:y}=a,m=F.useRef(null),u=F.useRef(new Map).current;return E.jsx(d,{scope:s,itemMap:u,collectionRef:m,children:y})};I.displayName=n;const S=e+"CollectionSlot",w=$(S),i=F.forwardRef((a,s)=>{const{scope:y,children:m}=a,u=c(S,y),h=k(s,u.collectionRef);return E.jsx(w,{ref:h,children:m})});i.displayName=S;const f=e+"CollectionItemSlot",l="data-radix-collection-item",R=$(f),g=F.forwardRef((a,s)=>{const{scope:y,children:m,...u}=a,h=F.useRef(null),b=k(s,h),x=c(f,y);return F.useEffect(()=>(x.itemMap.set(h,{ref:h,...u}),()=>void x.itemMap.delete(h))),E.jsx(R,{[l]:"",ref:b,children:m})});g.displayName=f;function p(a){const s=c(e+"CollectionConsumer",a);return F.useCallback(()=>{const m=s.collectionRef.current;if(!m)return[];const u=Array.from(m.querySelectorAll(`[${l}]`));return Array.from(s.itemMap.values()).sort((x,v)=>u.indexOf(x.ref.current)-u.indexOf(v.ref.current))},[s.collectionRef,s.itemMap])}return[{Provider:I,Slot:i,ItemSlot:g},p,t]}var me=r.createContext(void 0);function he(e){const n=r.useContext(me);return e||n||"ltr"}var D="rovingFocusGroup.onEntryFocus",Ce={bubbles:!1,cancelable:!0},_="RovingFocusGroup",[O,H,ve]=pe(_),[Ie,Ue]=B(_,[ve]),[Re,ge]=Ie(_),V=r.forwardRef((e,n)=>E.jsx(O.Provider,{scope:e.__scopeRovingFocusGroup,children:E.jsx(O.Slot,{scope:e.__scopeRovingFocusGroup,children:E.jsx(ye,{...e,ref:n})})}));V.displayName=_;var ye=r.forwardRef((e,n)=>{const{__scopeRovingFocusGroup:o,orientation:t,loop:d=!1,dir:c,currentTabStopId:I,defaultCurrentTabStopId:S,onCurrentTabStopIdChange:w,onEntryFocus:i,preventScrollOnEntryFocus:f=!1,...l}=e,R=r.useRef(null),g=k(n,R),p=he(c),[a,s]=re({prop:I,defaultProp:S??null,onChange:w,caller:_}),[y,m]=r.useState(!1),u=se(i),h=H(o),b=r.useRef(!1),[x,v]=r.useState(0);return r.useEffect(()=>{const C=R.current;if(C)return C.addEventListener(D,u),()=>C.removeEventListener(D,u)},[u]),E.jsx(Re,{scope:o,orientation:t,dir:p,loop:d,currentTabStopId:a,onItemFocus:r.useCallback(C=>s(C),[s]),onItemShiftTab:r.useCallback(()=>m(!0),[]),onFocusableItemAdd:r.useCallback(()=>v(C=>C+1),[]),onFocusableItemRemove:r.useCallback(()=>v(C=>C-1),[]),children:E.jsx(q.div,{tabIndex:y||x===0?-1:0,"data-orientation":t,...l,ref:g,style:{outline:"none",...e.style},onMouseDown:N(e.onMouseDown,()=>{b.current=!0}),onFocus:N(e.onFocus,C=>{const A=!b.current;if(C.target===C.currentTarget&&A&&!y){const M=new CustomEvent(D,Ce);if(C.currentTarget.dispatchEvent(M),!M.defaultPrevented){const P=h().filter(T=>T.focusable),Z=P.find(T=>T.active),ee=P.find(T=>T.id===a),te=[Z,ee,...P].filter(Boolean).map(T=>T.ref.current);J(te,f)}}b.current=!1}),onBlur:N(e.onBlur,()=>m(!1))})})}),W="RovingFocusGroupItem",Y=r.forwardRef((e,n)=>{const{__scopeRovingFocusGroup:o,focusable:t=!0,active:d=!1,tabStopId:c,children:I,...S}=e,w=ne(),i=c||w,f=ge(W,o),l=f.currentTabStopId===i,R=H(o),{onFocusableItemAdd:g,onFocusableItemRemove:p,currentTabStopId:a}=f;return r.useEffect(()=>{if(t)return g(),()=>p()},[t,g,p]),E.jsx(O.ItemSlot,{scope:o,id:i,focusable:t,active:d,children:E.jsx(q.span,{tabIndex:l?0:-1,"data-orientation":f.orientation,...S,ref:n,onMouseDown:N(e.onMouseDown,s=>{t?f.onItemFocus(i):s.preventDefault()}),onFocus:N(e.onFocus,()=>f.onItemFocus(i)),onKeyDown:N(e.onKeyDown,s=>{if(s.key==="Tab"&&s.shiftKey){f.onItemShiftTab();return}if(s.target!==s.currentTarget)return;const y=Se(s,f.orientation,f.dir);if(y!==void 0){if(s.metaKey||s.ctrlKey||s.altKey||s.shiftKey)return;s.preventDefault();let u=R().filter(h=>h.focusable).map(h=>h.ref.current);if(y==="last")u.reverse();else if(y==="prev"||y==="next"){y==="prev"&&u.reverse();const h=u.indexOf(s.currentTarget);u=f.loop?we(u,h+1):u.slice(h+1)}setTimeout(()=>J(u))}}),children:typeof I=="function"?I({isCurrentTabStop:l,hasTabStop:a!=null}):I})})});Y.displayName=W;var xe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Ee(e,n){return n!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Se(e,n,o){const t=Ee(e.key,o);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return xe[t]}function J(e,n=!1){const o=document.activeElement;for(const t of e)if(t===o||(t.focus({preventScroll:n}),document.activeElement!==o))return}function we(e,n){return e.map((o,t)=>e[(n+t)%e.length])}var $e=V,ze=Y;const X=ce(e=>({selectedNoteId:null,setSelectedNoteId:n=>e({selectedNoteId:n})})),U="https://linaform-server.onrender.com",Be=()=>{const e=K(),{accessToken:n}=L(),{setSelectedNoteId:o}=X();return G({mutationKey:["createNote"],mutationFn:async()=>await fetch(U+"/api/note/",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}}).then(async t=>{if(!t.ok)throw new Error((await t.json()).error||"Failed to create note");return await t.json()}),onSuccess:t=>{e.invalidateQueries({queryKey:["notes"]}),o(t.id)}})},qe=()=>{const e=K(),{accessToken:n}=L();return G({mutationKey:["updateNote"],mutationFn:async({id:o,...t})=>{await fetch(U+`/api/note/${o}`,{method:"PUT",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(t)}).then(d=>{if(!d.ok)throw new Error(d.status.toString())})},onError:o=>{console.log("Update failed",o)},onSuccess:(o,{id:t})=>{e.invalidateQueries({queryKey:["note",t]}),e.invalidateQueries({queryKey:["notes"]})}})},Qe=()=>{const e=K(),{accessToken:n}=L(),{setSelectedNoteId:o}=X();return G({mutationKey:["deleteNote"],mutationFn:async t=>{await fetch(U+`/api/note/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${n}`}}).then(d=>{if(!d.ok)throw new Error(d.status.toString())})},onError:t=>{console.log("Delete failed",t)},onSuccess:()=>{e.invalidateQueries({queryKey:["notes"]}),o(null)}})};class be extends r.Component{getSnapshotBeforeUpdate(n){const o=this.props.childRef.current;if(o&&n.isPresent&&!this.props.isPresent){const t=o.offsetParent,d=ae(t)&&t.offsetWidth||0,c=this.props.sizeRef.current;c.height=o.offsetHeight||0,c.width=o.offsetWidth||0,c.top=o.offsetTop,c.left=o.offsetLeft,c.right=d-c.width-c.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Te({children:e,isPresent:n,anchorX:o,root:t}){const d=r.useId(),c=r.useRef(null),I=r.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:S}=r.useContext(ie);return r.useInsertionEffect(()=>{const{width:w,height:i,top:f,left:l,right:R}=I.current;if(n||!c.current||!w||!i)return;const g=o==="left"?`left: ${l}`:`right: ${R}`;c.current.dataset.motionPopId=d;const p=document.createElement("style");S&&(p.nonce=S);const a=t??document.head;return a.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${d}"] {
            position: absolute !important;
            width: ${w}px !important;
            height: ${i}px !important;
            ${g}px !important;
            top: ${f}px !important;
          }
        `),()=>{a.contains(p)&&a.removeChild(p)}},[n]),E.jsx(be,{isPresent:n,childRef:c,sizeRef:I,children:r.cloneElement(e,{ref:c})})}const Fe=({children:e,initial:n,isPresent:o,onExitComplete:t,custom:d,presenceAffectsLayout:c,mode:I,anchorX:S,root:w})=>{const i=Q(Ne),f=r.useId();let l=!0,R=r.useMemo(()=>(l=!1,{id:f,initial:n,isPresent:o,custom:d,onExitComplete:g=>{i.set(g,!0);for(const p of i.values())if(!p)return;t&&t()},register:g=>(i.set(g,!1),()=>i.delete(g))}),[o,i,t]);return c&&l&&(R={...R}),r.useMemo(()=>{i.forEach((g,p)=>i.set(p,!1))},[o]),r.useEffect(()=>{!o&&!i.size&&t&&t()},[o]),I==="popLayout"&&(e=E.jsx(Te,{isPresent:o,anchorX:S,root:w,children:e})),E.jsx(ue.Provider,{value:R,children:e})};function Ne(){return new Map}const j=e=>e.key||"";function z(e){const n=[];return r.Children.forEach(e,o=>{r.isValidElement(o)&&n.push(o)}),n}const He=({children:e,custom:n,initial:o=!0,onExitComplete:t,presenceAffectsLayout:d=!0,mode:c="sync",propagate:I=!1,anchorX:S="left",root:w})=>{const[i,f]=le(I),l=r.useMemo(()=>z(e),[e]),R=I&&!i?[]:l.map(j),g=r.useRef(!0),p=r.useRef(l),a=Q(()=>new Map),[s,y]=r.useState(l),[m,u]=r.useState(l);fe(()=>{g.current=!1,p.current=l;for(let x=0;x<m.length;x++){const v=j(m[x]);R.includes(v)?a.delete(v):a.get(v)!==!0&&a.set(v,!1)}},[m,R.length,R.join("-")]);const h=[];if(l!==s){let x=[...l];for(let v=0;v<m.length;v++){const C=m[v],A=j(C);R.includes(A)||(x.splice(v,0,C),h.push(C))}return c==="wait"&&h.length&&(x=h),u(z(x)),y(l),null}const{forceRender:b}=r.useContext(de);return E.jsx(E.Fragment,{children:m.map(x=>{const v=j(x),C=I&&!i?!1:l===m||R.includes(v),A=()=>{if(a.has(v))a.set(v,!0);else return;let M=!0;a.forEach(P=>{P||(M=!1)}),M&&(b?.(),u(p.current),I&&f?.(),t&&t())};return E.jsx(Fe,{isPresent:C,initial:!g.current||o?void 0:!1,custom:n,presenceAffectsLayout:d,mode:c,root:w,onExitComplete:C?void 0:A,anchorX:S,children:x},v)})})};export{He as A,ze as I,$e as R,Ge as S,Ue as a,X as b,pe as c,Qe as d,Be as e,qe as f,he as u};
