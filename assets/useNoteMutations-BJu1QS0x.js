import{f as L,R as g,k as D,j as p,q as G,r as u,v as X,i as U,l as F,t as Z,g as ee,w as te,H as P,a as K,u as j}from"./index-BdNJeSBm.js";import"./schemas-NL9wyoGO.js";function oe(e){const o=e+"CollectionProvider",[r,t]=L(o),[m,C]=r(o,{collectionRef:{current:null},itemMap:new Map}),v=d=>{const{scope:n,children:i}=d,f=g.useRef(null),s=g.useRef(new Map).current;return p.jsx(m,{scope:n,itemMap:s,collectionRef:f,children:i})};v.displayName=o;const S=e+"CollectionSlot",x=G(S),I=g.forwardRef((d,n)=>{const{scope:i,children:f}=d,s=C(S,i),c=D(n,s.collectionRef);return p.jsx(x,{ref:c,children:f})});I.displayName=S;const a=e+"CollectionItemSlot",R="data-radix-collection-item",b=G(a),y=g.forwardRef((d,n)=>{const{scope:i,children:f,...s}=d,c=g.useRef(null),h=D(n,c),w=C(a,i);return g.useEffect(()=>(w.itemMap.set(c,{ref:c,...s}),()=>void w.itemMap.delete(c))),p.jsx(b,{[R]:"",ref:h,children:f})});y.displayName=a;function T(d){const n=C(e+"CollectionConsumer",d);return g.useCallback(()=>{const f=n.collectionRef.current;if(!f)return[];const s=Array.from(f.querySelectorAll(`[${R}]`));return Array.from(n.itemMap.values()).sort((w,A)=>s.indexOf(w.ref.current)-s.indexOf(A.ref.current))},[n.collectionRef,n.itemMap])}return[{Provider:v,Slot:I,ItemSlot:y},T,t]}var ne=u.createContext(void 0);function re(e){const o=u.useContext(ne);return e||o||"ltr"}var M="rovingFocusGroup.onEntryFocus",se={bubbles:!1,cancelable:!0},N="RovingFocusGroup",[O,q,ce]=oe(N),[ae,Se]=L(N,[ce]),[ie,ue]=ae(N),B=u.forwardRef((e,o)=>p.jsx(O.Provider,{scope:e.__scopeRovingFocusGroup,children:p.jsx(O.Slot,{scope:e.__scopeRovingFocusGroup,children:p.jsx(le,{...e,ref:o})})}));B.displayName=N;var le=u.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:r,orientation:t,loop:m=!1,dir:C,currentTabStopId:v,defaultCurrentTabStopId:S,onCurrentTabStopIdChange:x,onEntryFocus:I,preventScrollOnEntryFocus:a=!1,...R}=e,b=u.useRef(null),y=D(o,b),T=re(C),[d,n]=Z({prop:v,defaultProp:S??null,onChange:x,caller:N}),[i,f]=u.useState(!1),s=ee(I),c=q(r),h=u.useRef(!1),[w,A]=u.useState(0);return u.useEffect(()=>{const l=b.current;if(l)return l.addEventListener(M,s),()=>l.removeEventListener(M,s)},[s]),p.jsx(ie,{scope:r,orientation:t,dir:T,loop:m,currentTabStopId:d,onItemFocus:u.useCallback(l=>n(l),[n]),onItemShiftTab:u.useCallback(()=>f(!0),[]),onFocusableItemAdd:u.useCallback(()=>A(l=>l+1),[]),onFocusableItemRemove:u.useCallback(()=>A(l=>l-1),[]),children:p.jsx(U.div,{tabIndex:i||w===0?-1:0,"data-orientation":t,...R,ref:y,style:{outline:"none",...e.style},onMouseDown:F(e.onMouseDown,()=>{h.current=!0}),onFocus:F(e.onFocus,l=>{const V=!h.current;if(l.target===l.currentTarget&&V&&!i){const k=new CustomEvent(M,se);if(l.currentTarget.dispatchEvent(k),!k.defaultPrevented){const _=c().filter(E=>E.focusable),Y=_.find(E=>E.active),J=_.find(E=>E.id===d),W=[Y,J,..._].filter(Boolean).map(E=>E.ref.current);z(W,a)}}h.current=!1}),onBlur:F(e.onBlur,()=>f(!1))})})}),$="RovingFocusGroupItem",Q=u.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:r,focusable:t=!0,active:m=!1,tabStopId:C,children:v,...S}=e,x=X(),I=C||x,a=ue($,r),R=a.currentTabStopId===I,b=q(r),{onFocusableItemAdd:y,onFocusableItemRemove:T,currentTabStopId:d}=a;return u.useEffect(()=>{if(t)return y(),()=>T()},[t,y,T]),p.jsx(O.ItemSlot,{scope:r,id:I,focusable:t,active:m,children:p.jsx(U.span,{tabIndex:R?0:-1,"data-orientation":a.orientation,...S,ref:o,onMouseDown:F(e.onMouseDown,n=>{t?a.onItemFocus(I):n.preventDefault()}),onFocus:F(e.onFocus,()=>a.onItemFocus(I)),onKeyDown:F(e.onKeyDown,n=>{if(n.key==="Tab"&&n.shiftKey){a.onItemShiftTab();return}if(n.target!==n.currentTarget)return;const i=me(n,a.orientation,a.dir);if(i!==void 0){if(n.metaKey||n.ctrlKey||n.altKey||n.shiftKey)return;n.preventDefault();let s=b().filter(c=>c.focusable).map(c=>c.ref.current);if(i==="last")s.reverse();else if(i==="prev"||i==="next"){i==="prev"&&s.reverse();const c=s.indexOf(n.currentTarget);s=a.loop?pe(s,c+1):s.slice(c+1)}setTimeout(()=>z(s))}}),children:typeof v=="function"?v({isCurrentTabStop:R,hasTabStop:d!=null}):v})})});Q.displayName=$;var de={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function fe(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function me(e,o,r){const t=fe(e.key,r);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return de[t]}function z(e,o=!1){const r=document.activeElement;for(const t of e)if(t===r||(t.focus({preventScroll:o}),document.activeElement!==r))return}function pe(e,o){return e.map((r,t)=>e[(o+t)%e.length])}var Re=B,ye=Q;const H=te(e=>({selectedNoteId:null,setSelectedNoteId:o=>e({selectedNoteId:o})})),Ee=()=>{const e=P(),{accessToken:o}=K(),{setSelectedNoteId:r}=H();return j({mutationKey:["createNote"],mutationFn:async()=>await fetch("/api/note/",{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}}).then(async t=>{if(!t.ok)throw new Error((await t.json()).error||"Failed to create note");return await t.json()}),onSuccess:t=>{e.invalidateQueries({queryKey:["notes"]}),r(t.id)}})},ge=()=>{const e=P(),{accessToken:o}=K();return j({mutationKey:["updateNote"],mutationFn:async({id:r,...t})=>{await fetch(`/api/note/${r}`,{method:"PUT",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(t)}).then(m=>{if(!m.ok)throw new Error(m.status.toString())})},onError:r=>{console.log("Update failed",r)},onSuccess:(r,{id:t})=>{e.invalidateQueries({queryKey:["note",t]}),e.invalidateQueries({queryKey:["notes"]})}})},be=()=>{const e=P(),{accessToken:o}=K(),{setSelectedNoteId:r}=H();return j({mutationKey:["deleteNote"],mutationFn:async t=>{await fetch(`/api/note/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}}).then(m=>{if(!m.ok)throw new Error(m.status.toString())})},onError:t=>{console.log("Delete failed",t)},onSuccess:()=>{e.invalidateQueries({queryKey:["notes"]}),r(null)}})};export{ye as I,Re as R,Se as a,H as b,oe as c,be as d,Ee as e,ge as f,re as u};
