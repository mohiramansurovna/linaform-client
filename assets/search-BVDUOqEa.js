import{r as y,j as e}from"./index-DluB5dCl.js";import{P as m}from"./post-EMleDULP.js";import{u as h,S as v}from"./search-input-8DZZICGP.js";import{I as w}from"./schemas-DY3pto_e.js";import{B as u}from"./createLucideIcon-0o6u6YEZ.js";import{u as S}from"./useAuthStore-fUHCbePb.js";import{L as b}from"./loader-circle-fnBM1XxQ.js";import"./useUserStore-BA4mL2BW.js";import"./react-BTsYd7cd.js";import"./useBaseQuery-HNIRHYnW.js";import"./search-C1jLN-wh.js";const d="https://linaform-server.onrender.com",L=a=>h({queryKey:["seachGlobalPosts"],queryFn:async({pageParam:t=1})=>await(await fetch(d+`/api/post/search/${t}?search=${a}`)).json(),initialPageParam:1,getNextPageParam:t=>t.nextPage,enabled:!!a}),C=()=>h({queryKey:["popularGlobalPosts"],queryFn:async({pageParam:a=1})=>await(await fetch(d+`/api/post/popular/${a}`)).json(),initialPageParam:1,getNextPageParam:a=>a.nextPage});function E(){const{data:a,isLoading:t,hasNextPage:n,fetchNextPage:f,isFetchingNextPage:l}=C(),r=a?.pages.flatMap(o=>o.posts)??[],[s,p]=y.useState(null),{data:g,isLoading:i,hasNextPage:P,fetchNextPage:N,isFetchingNextPage:c}=L(s),x=g?.pages.flatMap(o=>o.posts)??[],{isAuthenticated:j}=S();return e.jsxs("div",{className:"flex flex-col items-center w-full h-full",children:[e.jsxs("div",{style:{marginTop:j?0:60},className:"fixed top-0 w-[70%] bg-background h-40 flex flex-col justify-around items-center ",children:[e.jsx("h1",{className:"text-5xl font-delius-swash-caps text-zinc-800 dark:text-zinc-100",children:"Linaform"}),e.jsx(v,{value:s??"",setValue:p,Component:w,containerClassName:"w-full max-w-xl",classname:"rounded-full",placeholder:"Search for posts"})]}),e.jsxs("div",{className:"flex flex-col gap-4 mt-46 w-[70%]",children:[(t||i)&&e.jsx("div",{className:"flex justify-center items-center h-[60vh]",children:e.jsx(b,{className:"h-10 w-10 animate-spin text-zinc-500"})}),!s&&r&&e.jsx(m,{posts:r,containerClassName:"flex-1 overflow-y-auto"}),s&&x&&e.jsx(m,{posts:r,containerClassName:"flex-1 overflow-y-auto"}),!i&&s&&x.length===0||!t&&!s&&r.length===0&&e.jsxs("p",{className:"self-center text-center mt-20 text-zinc-500",children:["Oops, there is no result for your search.",e.jsx("br",{}),e.jsx("a",{href:"/results/search",className:"hover:text-primary underline underline-offset-4",children:"Try exploring"})]})]}),n&&!s&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(u,{onClick:()=>f(),disabled:l,className:"rounded-xl",variant:"outline",children:l?"Loading...":"Load More"})}),P&&s&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(u,{onClick:()=>N(),disabled:c,className:"rounded-xl",variant:"outline",children:c?"Loading...":"Load More"})})]})}export{E as default};
