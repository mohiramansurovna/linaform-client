import{aa as d,r as j,j as e,B as x}from"./index-BcR0Qb-V.js";import{P as h}from"./post-DyxCNtlZ.js";import{I as y}from"./schemas-BWUwtsDD.js";import{S as v}from"./search-input-QWI4HMMx.js";import{L}from"./loader-circle-B_WZVwAO.js";import"./search-B81CmA2F.js";const m="https://linaform-server.onrender.com",S=s=>d({queryKey:["seachGlobalPosts"],queryFn:async({pageParam:r=1})=>await(await fetch(m+`/api/post/search/${r}?search=${s}`)).json(),initialPageParam:1,getNextPageParam:r=>r.nextPage,enabled:!!s}),w=()=>d({queryKey:["popularGlobalPosts"],queryFn:async({pageParam:s=1})=>await(await fetch(m+`/api/post/popular/${s}`)).json(),initialPageParam:1,getNextPageParam:s=>s.nextPage});function G(){const{data:s,isLoading:r,hasNextPage:n,fetchNextPage:u,isFetchingNextPage:l}=w(),i=s?.pages.flatMap(a=>a.posts)??[],[t,p]=j.useState(null),{data:f,isLoading:g,hasNextPage:P,fetchNextPage:N,isFetchingNextPage:o}=S(t),c=f?.pages.flatMap(a=>a.posts)??[];return e.jsxs("div",{className:"flex flex-col w-full px-6 md:px-20 py-10 gap-6",children:[e.jsxs("div",{className:"flex flex-col items-center gap-8",children:[e.jsx("h1",{className:"text-5xl font-delius-swash-caps text-zinc-800 dark:text-zinc-100",children:"Linaform"}),e.jsx(v,{value:t??"",setValue:p,Component:y,containerClassName:"w-full max-w-xl",classname:"rounded-full",placeholder:"Search for posts"})]}),e.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[(r||g)&&e.jsx("div",{className:"flex justify-center items-center h-[60vh]",children:e.jsx(L,{className:"h-10 w-10 animate-spin text-zinc-500"})}),!t&&i?.map(a=>e.jsx(h,{post:a},a.id)),t&&c?.map(a=>e.jsx(h,{post:a},a.id)),t&&c.length===0||!t&&i.length===0&&e.jsxs("p",{className:"self-center text-center mt-20 text-zinc-500",children:["Oops, there is no result for your search.",e.jsx("br",{}),e.jsx("a",{href:"/results/search",className:"hover:text-primary underline underline-offset-4",children:"Try exploring"})]})]}),n&&!t&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(x,{onClick:()=>u(),disabled:l,className:"rounded-xl",variant:"outline",children:l?"Loading...":"Load More"})}),P&&t&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(x,{onClick:()=>N(),disabled:o,className:"rounded-xl",variant:"outline",children:o?"Loading...":"Load More"})})]})}export{G as default};
