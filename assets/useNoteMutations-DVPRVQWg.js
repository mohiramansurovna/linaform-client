import{f as U,R as g,k as D,j as p,q as L,r as u,v as Z,i as q,l as F,t as ee,g as te,w as oe,H as P,a as K,u as j}from"./index-Tjubhkso.js";import"./schemas-Dvu2-DyR.js";function ne(e){const o=e+"CollectionProvider",[r,t]=U(o),[m,C]=r(o,{collectionRef:{current:null},itemMap:new Map}),v=d=>{const{scope:n,children:i}=d,f=g.useRef(null),s=g.useRef(new Map).current;return p.jsx(m,{scope:n,itemMap:s,collectionRef:f,children:i})};v.displayName=o;const S=e+"CollectionSlot",x=L(S),I=g.forwardRef((d,n)=>{const{scope:i,children:f}=d,s=C(S,i),c=D(n,s.collectionRef);return p.jsx(x,{ref:c,children:f})});I.displayName=S;const a=e+"CollectionItemSlot",R="data-radix-collection-item",b=L(a),y=g.forwardRef((d,n)=>{const{scope:i,children:f,...s}=d,c=g.useRef(null),T=D(n,c),w=C(a,i);return g.useEffect(()=>(w.itemMap.set(c,{ref:c,...s}),()=>void w.itemMap.delete(c))),p.jsx(b,{[R]:"",ref:T,children:f})});y.displayName=a;function h(d){const n=C(e+"CollectionConsumer",d);return g.useCallback(()=>{const f=n.collectionRef.current;if(!f)return[];const s=Array.from(f.querySelectorAll(`[${R}]`));return Array.from(n.itemMap.values()).sort((w,A)=>s.indexOf(w.ref.current)-s.indexOf(A.ref.current))},[n.collectionRef,n.itemMap])}return[{Provider:v,Slot:I,ItemSlot:y},h,t]}var re=u.createContext(void 0);function se(e){const o=u.useContext(re);return e||o||"ltr"}var M="rovingFocusGroup.onEntryFocus",ce={bubbles:!1,cancelable:!0},N="RovingFocusGroup",[O,B,ae]=ne(N),[ie,Re]=U(N,[ae]),[ue,le]=ie(N),$=u.forwardRef((e,o)=>p.jsx(O.Provider,{scope:e.__scopeRovingFocusGroup,children:p.jsx(O.Slot,{scope:e.__scopeRovingFocusGroup,children:p.jsx(de,{...e,ref:o})})}));$.displayName=N;var de=u.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:r,orientation:t,loop:m=!1,dir:C,currentTabStopId:v,defaultCurrentTabStopId:S,onCurrentTabStopIdChange:x,onEntryFocus:I,preventScrollOnEntryFocus:a=!1,...R}=e,b=u.useRef(null),y=D(o,b),h=se(C),[d,n]=ee({prop:v,defaultProp:S??null,onChange:x,caller:N}),[i,f]=u.useState(!1),s=te(I),c=B(r),T=u.useRef(!1),[w,A]=u.useState(0);return u.useEffect(()=>{const l=b.current;if(l)return l.addEventListener(M,s),()=>l.removeEventListener(M,s)},[s]),p.jsx(ue,{scope:r,orientation:t,dir:h,loop:m,currentTabStopId:d,onItemFocus:u.useCallback(l=>n(l),[n]),onItemShiftTab:u.useCallback(()=>f(!0),[]),onFocusableItemAdd:u.useCallback(()=>A(l=>l+1),[]),onFocusableItemRemove:u.useCallback(()=>A(l=>l-1),[]),children:p.jsx(q.div,{tabIndex:i||w===0?-1:0,"data-orientation":t,...R,ref:y,style:{outline:"none",...e.style},onMouseDown:F(e.onMouseDown,()=>{T.current=!0}),onFocus:F(e.onFocus,l=>{const Y=!T.current;if(l.target===l.currentTarget&&Y&&!i){const G=new CustomEvent(M,ce);if(l.currentTarget.dispatchEvent(G),!G.defaultPrevented){const _=c().filter(E=>E.focusable),J=_.find(E=>E.active),W=_.find(E=>E.id===d),X=[J,W,..._].filter(Boolean).map(E=>E.ref.current);H(X,a)}}T.current=!1}),onBlur:F(e.onBlur,()=>f(!1))})})}),Q="RovingFocusGroupItem",z=u.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:r,focusable:t=!0,active:m=!1,tabStopId:C,children:v,...S}=e,x=Z(),I=C||x,a=le(Q,r),R=a.currentTabStopId===I,b=B(r),{onFocusableItemAdd:y,onFocusableItemRemove:h,currentTabStopId:d}=a;return u.useEffect(()=>{if(t)return y(),()=>h()},[t,y,h]),p.jsx(O.ItemSlot,{scope:r,id:I,focusable:t,active:m,children:p.jsx(q.span,{tabIndex:R?0:-1,"data-orientation":a.orientation,...S,ref:o,onMouseDown:F(e.onMouseDown,n=>{t?a.onItemFocus(I):n.preventDefault()}),onFocus:F(e.onFocus,()=>a.onItemFocus(I)),onKeyDown:F(e.onKeyDown,n=>{if(n.key==="Tab"&&n.shiftKey){a.onItemShiftTab();return}if(n.target!==n.currentTarget)return;const i=pe(n,a.orientation,a.dir);if(i!==void 0){if(n.metaKey||n.ctrlKey||n.altKey||n.shiftKey)return;n.preventDefault();let s=b().filter(c=>c.focusable).map(c=>c.ref.current);if(i==="last")s.reverse();else if(i==="prev"||i==="next"){i==="prev"&&s.reverse();const c=s.indexOf(n.currentTarget);s=a.loop?Ie(s,c+1):s.slice(c+1)}setTimeout(()=>H(s))}}),children:typeof v=="function"?v({isCurrentTabStop:R,hasTabStop:d!=null}):v})})});z.displayName=Q;var fe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function me(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function pe(e,o,r){const t=me(e.key,r);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return fe[t]}function H(e,o=!1){const r=document.activeElement;for(const t of e)if(t===r||(t.focus({preventScroll:o}),document.activeElement!==r))return}function Ie(e,o){return e.map((r,t)=>e[(o+t)%e.length])}var ye=$,Ee=z;const V=oe(e=>({selectedNoteId:null,setSelectedNoteId:o=>e({selectedNoteId:o})})),k="https://linaform-server.onrender.com",ge=()=>{const e=P(),{accessToken:o}=K(),{setSelectedNoteId:r}=V();return j({mutationKey:["createNote"],mutationFn:async()=>await fetch(k+"/api/note/",{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}}).then(async t=>{if(!t.ok)throw new Error((await t.json()).error||"Failed to create note");return await t.json()}),onSuccess:t=>{e.invalidateQueries({queryKey:["notes"]}),r(t.id)}})},be=()=>{const e=P(),{accessToken:o}=K();return j({mutationKey:["updateNote"],mutationFn:async({id:r,...t})=>{await fetch(k+`/api/note/${r}`,{method:"PUT",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(t)}).then(m=>{if(!m.ok)throw new Error(m.status.toString())})},onError:r=>{console.log("Update failed",r)},onSuccess:(r,{id:t})=>{e.invalidateQueries({queryKey:["note",t]}),e.invalidateQueries({queryKey:["notes"]})}})},he=()=>{const e=P(),{accessToken:o}=K(),{setSelectedNoteId:r}=V();return j({mutationKey:["deleteNote"],mutationFn:async t=>{await fetch(k+`/api/note/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}}).then(m=>{if(!m.ok)throw new Error(m.status.toString())})},onError:t=>{console.log("Delete failed",t)},onSuccess:()=>{e.invalidateQueries({queryKey:["notes"]}),r(null)}})};export{Ee as I,ye as R,Re as a,V as b,ne as c,he as d,ge as e,be as f,se as u};
