import{aa as d,r as N,j as e,B as x}from"./index-BdNJeSBm.js";import{P as h}from"./post-DKB_M-AR.js";import{I as j}from"./schemas-NL9wyoGO.js";import{S as y}from"./search-input-CATZNi8Y.js";import{L as v}from"./loader-circle-CJj6Patn.js";import"./search-Ct6-JZbQ.js";const L=s=>d({queryKey:["seachGlobalPosts"],queryFn:async({pageParam:r=1})=>await(await fetch(`/api/post/search/${r}?search=${s}`)).json(),initialPageParam:1,getNextPageParam:r=>r.nextPage,enabled:!!s}),S=()=>d({queryKey:["popularGlobalPosts"],queryFn:async({pageParam:s=1})=>await(await fetch(`/api/post/popular/${s}`)).json(),initialPageParam:1,getNextPageParam:s=>s.nextPage});function z(){const{data:s,isLoading:r,hasNextPage:n,fetchNextPage:m,isFetchingNextPage:l}=S(),i=s?.pages.flatMap(a=>a.posts)??[],[t,u]=N.useState(null),{data:p,isLoading:f,hasNextPage:g,fetchNextPage:P,isFetchingNextPage:c}=L(t),o=p?.pages.flatMap(a=>a.posts)??[];return e.jsxs("div",{className:"flex flex-col w-full px-6 md:px-20 py-10 gap-6",children:[e.jsxs("div",{className:"flex flex-col items-center gap-8",children:[e.jsx("h1",{className:"text-5xl font-delius-swash-caps text-zinc-800 dark:text-zinc-100",children:"Linaform"}),e.jsx(y,{value:t??"",setValue:u,Component:j,containerClassName:"w-full max-w-xl",classname:"rounded-full",placeholder:"Search for posts"})]}),e.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[(r||f)&&e.jsx("div",{className:"flex justify-center items-center h-[60vh]",children:e.jsx(v,{className:"h-10 w-10 animate-spin text-zinc-500"})}),!t&&i?.map(a=>e.jsx(h,{post:a},a.id)),t&&o?.map(a=>e.jsx(h,{post:a},a.id)),t&&o.length===0||!t&&i.length===0&&e.jsxs("p",{className:"self-center text-center mt-20 text-zinc-500",children:["Oops, there is no result for your search.",e.jsx("br",{}),e.jsx("a",{href:"/results/search",className:"hover:text-primary underline underline-offset-4",children:"Try exploring"})]})]}),n&&!t&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(x,{onClick:()=>m(),disabled:l,className:"rounded-xl",variant:"outline",children:l?"Loading...":"Load More"})}),g&&t&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(x,{onClick:()=>P(),disabled:c,className:"rounded-xl",variant:"outline",children:c?"Loading...":"Load More"})})]})}export{z as default};
