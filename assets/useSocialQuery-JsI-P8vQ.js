import{r as u,j as c}from"./index-DluB5dCl.js";import{c as I,b as N,I as m,u as h}from"./sidebar-Chdp4x4K.js";import{P as v}from"./index-BEeqayWG.js";import{s as R}from"./index-Dp86KSMC.js";import{a as g}from"./createLucideIcon-0o6u6YEZ.js";import{u as x}from"./search-input-8DZZICGP.js";import{u as w}from"./useAuthStore-fUHCbePb.js";function C(){return R.useSyncExternalStore(F,()=>!0,()=>!1)}function F(){return()=>{}}var p="Avatar",[q,W]=I(p),[_,P]=q(p),S=u.forwardRef((e,a)=>{const{__scopeAvatar:r,...s}=e,[n,t]=u.useState("idle");return c.jsx(_,{scope:r,imageLoadingStatus:n,onImageLoadingStatusChange:t,children:c.jsx(v.span,{...s,ref:a})})});S.displayName=p;var L="AvatarImage",E=u.forwardRef((e,a)=>{const{__scopeAvatar:r,src:s,onLoadingStatusChange:n=()=>{},...t}=e,l=P(L,r),o=$(s,t),i=N(d=>{n(d),l.onImageLoadingStatusChange(d)});return m(()=>{o!=="idle"&&i(o)},[o,i]),o==="loaded"?c.jsx(v.img,{...t,ref:a,src:s}):null});E.displayName=L;var b="AvatarFallback",j=u.forwardRef((e,a)=>{const{__scopeAvatar:r,delayMs:s,...n}=e,t=P(b,r),[l,o]=u.useState(s===void 0);return u.useEffect(()=>{if(s!==void 0){const i=window.setTimeout(()=>o(!0),s);return()=>window.clearTimeout(i)}},[s]),l&&t.imageLoadingStatus!=="loaded"?c.jsx(v.span,{...n,ref:a}):null});j.displayName=b;function y(e,a){return e?a?(e.src!==a&&(e.src=a),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function $(e,{referrerPolicy:a,crossOrigin:r}){const s=C(),n=u.useRef(null),t=s?(n.current||(n.current=new window.Image),n.current):null,[l,o]=u.useState(()=>y(t,e));return m(()=>{o(y(t,e))},[t,e]),m(()=>{const i=k=>()=>{o(k)};if(!t)return;const d=i("loaded"),A=i("error");return t.addEventListener("load",d),t.addEventListener("error",A),a&&(t.referrerPolicy=a),typeof r=="string"&&(t.crossOrigin=r),()=>{t.removeEventListener("load",d),t.removeEventListener("error",A)}},[t,r,a]),l}var z=S,K=E,M=j;function D({className:e,...a}){return c.jsx(z,{"data-slot":"avatar",className:g("relative flex size-8 shrink-0 overflow-hidden rounded-full",e),...a})}function J({className:e,...a}){return c.jsx(K,{"data-slot":"avatar-image",className:g("aspect-square size-full",e),...a})}function X({className:e,...a}){return c.jsx(M,{"data-slot":"avatar-fallback",className:g("bg-muted flex size-full items-center justify-center rounded-full",e),...a})}const f="https://linaform-server.onrender.com",Y=()=>{const{accessToken:e}=w();return x({queryKey:["likedPosts"],queryFn:async({pageParam:a=1})=>await(await fetch(f+`/api/social/likedPosts/${a}`,{headers:{Authorization:`Bearer ${e}`}})).json(),initialPageParam:1,getNextPageParam:a=>a.nextPage})},Z=()=>{const{accessToken:e}=w();return h({queryKey:["following"],queryFn:async()=>{const a=await fetch(f+"/api/social/following",{headers:{Authorization:`Bearer ${e}`}});if(!a.ok)throw new Error("Failed to authors notes");return await a.json()}})},O=e=>h({queryKey:["user"],queryFn:async()=>await(await fetch(f+"/api/social/user/"+e)).json(),enabled:!!e}),ee=e=>x({queryKey:["authorPosts"],queryFn:async({pageParam:a=1})=>await(await fetch(f+`/api/social/authorPosts/${e}/${a}`)).json(),initialPageParam:1,getNextPageParam:a=>a.nextPage,enabled:!!e});export{D as A,J as a,X as b,O as c,Y as d,ee as e,Z as u};
