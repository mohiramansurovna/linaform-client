const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/file-DUSCBxGv.js","assets/index-DluB5dCl.js","assets/index-DD7TmI1W.css","assets/createLucideIcon-0o6u6YEZ.js","assets/index-LMDZ4JDy.js","assets/sidebar-Chdp4x4K.js","assets/useBaseQuery-HNIRHYnW.js","assets/schemas-DY3pto_e.js","assets/index-BEeqayWG.js","assets/useAuthStore-fUHCbePb.js","assets/react-BTsYd7cd.js","assets/useMutation-BezK9uMc.js","assets/proxy-BtzyRkJ0.js","assets/dialog-CUU9GurP.js","assets/command-BF7lyB6a.js","assets/search-C1jLN-wh.js","assets/loading-D-BgD5Rj.js","assets/loader-B2PTu4nb.js","assets/chevrons-right-A25g8XOk.js","assets/check-check-C8wSDcBb.js","assets/loader-circle-fnBM1XxQ.js","assets/index-Dp86KSMC.js","assets/index-BLF7ElBw.js","assets/useThemeStore-DjIK0vOl.js","assets/text-CI7k394y.js","assets/toggle-D_N74tNA.js","assets/font-Dioqu7Te.js","assets/structure-VTw6waI0.js","assets/popover-CzBuos2i.js","assets/insert-h76UoTLW.js"])))=>i.map(i=>d[i]);
import{g as St,b as cr,R as $,r as d,j as c,c as xe,_ as ae}from"./index-DluB5dCl.js";import{c as ur,P as lr,j as dr,k as fr,e as ze,u as hr,T as _e,E as Se,G as Te,H as gt}from"./sidebar-Chdp4x4K.js";import{u as pr,a as Tt,R as mr,I as vr,b as oe,f as gr,S as we,A as yr}from"./index-LMDZ4JDy.js";import{R as br,P as Ce}from"./index-BEeqayWG.js";import{c as ce,a as je,B as Fe}from"./createLucideIcon-0o6u6YEZ.js";import{u as wt}from"./useAuthStore-fUHCbePb.js";import{N as xr}from"./schemas-DY3pto_e.js";import{C as _r}from"./check-check-C8wSDcBb.js";import{L as Sr}from"./loader-circle-fnBM1XxQ.js";import{m as Tr}from"./proxy-BtzyRkJ0.js";import{r as wr,s as Ct}from"./index-Dp86KSMC.js";import{E as Cr,u as jr,r as Er,S as Nr,H as Ar,T as Ir,a as Rr,F as Mr,b as Dr,C as Or,B as Pr,I as Lr,M as zr}from"./index-BLF7ElBw.js";import{u as Fr}from"./useThemeStore-DjIK0vOl.js";import{a as Br}from"./loading-D-BgD5Rj.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["path",{d:"M20 12v5",key:"12wsvk"}],["path",{d:"M20 21h.01",key:"1p6o6n"}],["path",{d:"M21.25 8.2A10 10 0 1 0 16 21.16",key:"17fp9f"}]],qr=ce("clock-alert",$r);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Gr=ce("clock",Ur);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],kr=ce("redo",Vr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=[["path",{d:"M12.034 12.681a.498.498 0 0 1 .647-.647l9 3.5a.5.5 0 0 1-.033.943l-3.444 1.068a1 1 0 0 0-.66.66l-1.067 3.443a.5.5 0 0 1-.943.033z",key:"xwnzip"}],["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M9 3h1",key:"1yesri"}],["path",{d:"M9 21h2",key:"1qve2z"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M21 9v2",key:"p14lih"}],["path",{d:"M3 14v1",key:"vnatye"}]],Kr=ce("square-dashed-mouse-pointer",Hr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],Jr=ce("undo",Wr);var Be,yt;function Qr(){return yt||(yt=1,Be=function r(n,s){if(n===s)return!0;if(n&&s&&typeof n=="object"&&typeof s=="object"){if(n.constructor!==s.constructor)return!1;var i,a,u;if(Array.isArray(n)){if(i=n.length,i!=s.length)return!1;for(a=i;a--!==0;)if(!r(n[a],s[a]))return!1;return!0}if(n instanceof Map&&s instanceof Map){if(n.size!==s.size)return!1;for(a of n.entries())if(!s.has(a[0]))return!1;for(a of n.entries())if(!r(a[1],s.get(a[0])))return!1;return!0}if(n instanceof Set&&s instanceof Set){if(n.size!==s.size)return!1;for(a of n.entries())if(!s.has(a[0]))return!1;return!0}if(ArrayBuffer.isView(n)&&ArrayBuffer.isView(s)){if(i=n.length,i!=s.length)return!1;for(a=i;a--!==0;)if(n[a]!==s[a])return!1;return!0}if(n.constructor===RegExp)return n.source===s.source&&n.flags===s.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===s.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===s.toString();if(u=Object.keys(n),i=u.length,i!==Object.keys(s).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(s,u[a]))return!1;for(a=i;a--!==0;){var h=u[a];if(!(h==="_owner"&&n.$$typeof)&&!r(n[h],s[h]))return!1}return!0}return n!==n&&s!==s}),Be}var Xr=Qr();const Yr=St(Xr);var $e={exports:{}},qe={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bt;function Zr(){if(bt)return qe;bt=1;var r=cr(),n=wr();function s(x,m){return x===m&&(x!==0||1/x===1/m)||x!==x&&m!==m}var i=typeof Object.is=="function"?Object.is:s,a=n.useSyncExternalStore,u=r.useRef,h=r.useEffect,p=r.useMemo,y=r.useDebugValue;return qe.useSyncExternalStoreWithSelector=function(x,m,S,j,D){var q=u(null);if(q.current===null){var R={hasValue:!1,value:null};q.current=R}else R=q.current;q=p(function(){function ue(E){if(!P){if(P=!0,H=E,E=j(E),D!==void 0&&R.hasValue){var L=R.value;if(D(L,E))return Y=L}return Y=E}if(L=Y,i(H,E))return L;var le=j(E);return D!==void 0&&D(L,le)?(H=E,L):(H=E,Y=le)}var P=!1,H,Y,ee=S===void 0?null:S;return[function(){return ue(m())},ee===null?void 0:function(){return ue(ee())}]},[m,S,j,D]);var k=a(x,q[0],q[1]);return h(function(){R.hasValue=!0,R.value=k},[k]),y(k),k},qe}var xt;function es(){return xt||(xt=1,$e.exports=Zr()),$e.exports}var ts=es(),ns=(...r)=>n=>{r.forEach(s=>{typeof s=="function"?s(n):s&&(s.current=n)})},rs=({contentComponent:r})=>{const n=Ct.useSyncExternalStore(r.subscribe,r.getSnapshot,r.getServerSnapshot);return c.jsx(c.Fragment,{children:Object.values(n)})};function ss(){const r=new Set;let n={};return{subscribe(s){return r.add(s),()=>{r.delete(s)}},getSnapshot(){return n},getServerSnapshot(){return n},setRenderer(s,i){n={...n,[s]:br.createPortal(i.reactElement,i.element,s)},r.forEach(a=>a())},removeRenderer(s){const i={...n};delete i[s],n=i,r.forEach(a=>a())}}}var is=class extends $.Component{constructor(r){var n;super(r),this.editorContentRef=$.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((n=r.editor)!=null&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const r=this.props.editor;if(r&&!r.isDestroyed&&r.options.element){if(r.contentComponent)return;const n=this.editorContentRef.current;n.append(...r.options.element.childNodes),r.setOptions({element:n}),r.contentComponent=ss(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=r.contentComponent.subscribe(()=>{this.setState(s=>s.hasContentComponentInitialized?s:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),r.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var r;const n=this.props.editor;if(!n||(this.initialized=!1,n.isDestroyed||n.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),n.contentComponent=null,!((r=n.options.element)!=null&&r.firstChild)))return;const s=document.createElement("div");s.append(...n.options.element.childNodes),n.setOptions({element:s})}render(){const{editor:r,innerRef:n,...s}=this.props;return c.jsxs(c.Fragment,{children:[c.jsx("div",{ref:ns(n,this.editorContentRef),...s}),r?.contentComponent&&c.jsx(rs,{contentComponent:r.contentComponent})]})}},as=d.forwardRef((r,n)=>{const s=$.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[r.editor]);return $.createElement(is,{key:s,innerRef:n,...r})}),os=$.memo(as),cs=typeof window<"u"?d.useLayoutEffect:d.useEffect,us=class{constructor(r){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=r,this.lastSnapshot={editor:r,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(r){return this.subscribers.add(r),()=>{this.subscribers.delete(r)}}watch(r){if(this.editor=r,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},s=this.editor;return s.on("transaction",n),()=>{s.off("transaction",n)}}}};function ls(r){var n;const[s]=d.useState(()=>new us(r.editor)),i=ts.useSyncExternalStoreWithSelector(s.subscribe,s.getSnapshot,s.getServerSnapshot,r.selector,(n=r.equalityFn)!=null?n:Yr);return cs(()=>s.watch(r.editor),[r.editor,s]),d.useDebugValue(i),i}var ds=!1,Ue=typeof window>"u",fs=Ue||!!(typeof window<"u"&&window.next),hs=class jt{constructor(n){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=n,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(n){this.editor=n,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(s=>s())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Ue||fs?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const n={...this.options.current,onBeforeCreate:(...i)=>{var a,u;return(u=(a=this.options.current).onBeforeCreate)==null?void 0:u.call(a,...i)},onBlur:(...i)=>{var a,u;return(u=(a=this.options.current).onBlur)==null?void 0:u.call(a,...i)},onCreate:(...i)=>{var a,u;return(u=(a=this.options.current).onCreate)==null?void 0:u.call(a,...i)},onDestroy:(...i)=>{var a,u;return(u=(a=this.options.current).onDestroy)==null?void 0:u.call(a,...i)},onFocus:(...i)=>{var a,u;return(u=(a=this.options.current).onFocus)==null?void 0:u.call(a,...i)},onSelectionUpdate:(...i)=>{var a,u;return(u=(a=this.options.current).onSelectionUpdate)==null?void 0:u.call(a,...i)},onTransaction:(...i)=>{var a,u;return(u=(a=this.options.current).onTransaction)==null?void 0:u.call(a,...i)},onUpdate:(...i)=>{var a,u;return(u=(a=this.options.current).onUpdate)==null?void 0:u.call(a,...i)},onContentError:(...i)=>{var a,u;return(u=(a=this.options.current).onContentError)==null?void 0:u.call(a,...i)},onDrop:(...i)=>{var a,u;return(u=(a=this.options.current).onDrop)==null?void 0:u.call(a,...i)},onPaste:(...i)=>{var a,u;return(u=(a=this.options.current).onPaste)==null?void 0:u.call(a,...i)},onDelete:(...i)=>{var a,u;return(u=(a=this.options.current).onDelete)==null?void 0:u.call(a,...i)}};return new Cr(n)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(n){return this.subscriptions.add(n),()=>{this.subscriptions.delete(n)}}static compareOptions(n,s){return Object.keys(n).every(i=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(i)?!0:i==="extensions"&&n.extensions&&s.extensions?n.extensions.length!==s.extensions.length?!1:n.extensions.every((a,u)=>{var h;return a===((h=s.extensions)==null?void 0:h[u])}):n[i]===s[i])}onRender(n){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&n.length===0?jt.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(n),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(n){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=n;return}if(this.previousDeps.length===n.length&&this.previousDeps.every((i,a)=>i===n[a]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=n}scheduleDestroy(){const n=this.instanceId,s=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===n){s&&s.setOptions(this.options.current);return}s&&!s.isDestroyed&&(s.destroy(),this.instanceId===n&&this.setEditor(null))},1)}};function ps(r={},n=[]){const s=d.useRef(r);s.current=r;const[i]=d.useState(()=>new hs(s)),a=Ct.useSyncExternalStore(i.subscribe,i.getEditor,i.getServerSnapshot);return d.useDebugValue(a),d.useEffect(i.onRender(n)),ls({editor:a,selector:({transactionNumber:u})=>r.shouldRerenderOnTransaction===!1||r.shouldRerenderOnTransaction===void 0?null:r.immediatelyRender&&u===0?0:u+1}),a}var ms=d.createContext({editor:null});ms.Consumer;var vs=d.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),gs=()=>d.useContext(vs);$.forwardRef((r,n)=>{const{onDragStart:s}=gs(),i=r.as||"div";return c.jsx(i,{...r,ref:n,"data-node-view-wrapper":"",onDragStart:s,style:{whiteSpace:"normal",...r.style}})});$.createContext({markViewContentRef:()=>{}});var Ee="Tabs",[ys,ai]=ur(Ee,[Tt]),Et=Tt(),[bs,Ge]=ys(Ee),Nt=d.forwardRef((r,n)=>{const{__scopeTabs:s,value:i,onValueChange:a,defaultValue:u,orientation:h="horizontal",dir:p,activationMode:y="automatic",...x}=r,m=pr(p),[S,j]=dr({prop:i,onChange:a,defaultProp:u??"",caller:Ee});return c.jsx(bs,{scope:s,baseId:fr(),value:S,onValueChange:j,orientation:h,dir:m,activationMode:y,children:c.jsx(Ce.div,{dir:m,"data-orientation":h,...x,ref:n})})});Nt.displayName=Ee;var At="TabsList",It=d.forwardRef((r,n)=>{const{__scopeTabs:s,loop:i=!0,...a}=r,u=Ge(At,s),h=Et(s);return c.jsx(mr,{asChild:!0,...h,orientation:u.orientation,dir:u.dir,loop:i,children:c.jsx(Ce.div,{role:"tablist","aria-orientation":u.orientation,...a,ref:n})})});It.displayName=At;var Rt="TabsTrigger",Mt=d.forwardRef((r,n)=>{const{__scopeTabs:s,value:i,disabled:a=!1,...u}=r,h=Ge(Rt,s),p=Et(s),y=Pt(h.baseId,i),x=Lt(h.baseId,i),m=i===h.value;return c.jsx(vr,{asChild:!0,...p,focusable:!a,active:m,children:c.jsx(Ce.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":x,"data-state":m?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:y,...u,ref:n,onMouseDown:ze(r.onMouseDown,S=>{!a&&S.button===0&&S.ctrlKey===!1?h.onValueChange(i):S.preventDefault()}),onKeyDown:ze(r.onKeyDown,S=>{[" ","Enter"].includes(S.key)&&h.onValueChange(i)}),onFocus:ze(r.onFocus,()=>{const S=h.activationMode!=="manual";!m&&!a&&S&&h.onValueChange(i)})})})});Mt.displayName=Rt;var Dt="TabsContent",Ot=d.forwardRef((r,n)=>{const{__scopeTabs:s,value:i,forceMount:a,children:u,...h}=r,p=Ge(Dt,s),y=Pt(p.baseId,i),x=Lt(p.baseId,i),m=i===p.value,S=d.useRef(m);return d.useEffect(()=>{const j=requestAnimationFrame(()=>S.current=!1);return()=>cancelAnimationFrame(j)},[]),c.jsx(lr,{present:a||m,children:({present:j})=>c.jsx(Ce.div,{"data-state":m?"active":"inactive","data-orientation":p.orientation,role:"tabpanel","aria-labelledby":y,hidden:!j,id:x,tabIndex:0,...h,ref:n,style:{...r.style,animationDuration:S.current?"0s":void 0},children:j&&u})})});Ot.displayName=Dt;function Pt(r,n){return`${r}-trigger-${n}`}function Lt(r,n){return`${r}-content-${n}`}var xs=Nt,_s=It,Ss=Mt,Ts=Ot;function ws({className:r,...n}){return c.jsx(xs,{"data-slot":"tabs",className:je("flex flex-col gap-2",r),...n})}function Cs({className:r,...n}){return c.jsx(_s,{"data-slot":"tabs-list",className:je("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",r),...n})}function js({className:r,...n}){return c.jsx(Ss,{"data-slot":"tabs-trigger",className:je("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",r),...n})}function Es({className:r,...n}){return c.jsx(Ts,{"data-slot":"tabs-content",className:je("flex-1 outline-none",r),...n})}function Ns(r,n){let s;return function(...i){clearTimeout(s),s=setTimeout(()=>{r(...i)},n)}}const Ve=r=>{const{selectedNoteId:n}=oe(),[s,i]=d.useState("idle"),a=d.useRef(null),u=d.useMemo(()=>Ns(()=>{if(!r)return;const x=r.getJSON();localStorage.setItem(`note-${n}`,JSON.stringify(x)),i("saved"),a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{i("idle")},3e3)},3e3),[n,r]),h=d.useCallback(()=>{i("saving"),a.current&&clearTimeout(a.current),u()},[u]);d.useEffect(()=>{if(r)return r.on("update",h),()=>{r.off("update",h),a.current&&clearTimeout(a.current)}},[r,h]);const p=d.useCallback(()=>{try{const x=localStorage.getItem(`note-${n}`);return x?JSON.parse(x):null}catch{return null}},[n]);return{localSyncStatus:s,getLocalSync:p,clearLocalSync:()=>{localStorage.removeItem(`note-${n}`)}}},As="https://linaform-server.onrender.com",ke=()=>{const{accessToken:r}=wt(),{selectedNoteId:n}=oe();return hr({queryKey:["note",n],queryFn:async()=>{const s=await fetch(As+`/api/note/${n}`,{headers:{Authorization:`Bearer ${r}`}});if(!s.ok)throw new Error("Failed to fetch note");const i=xr.safeParse(await s.json());if(!i.success)throw new Error("Note is not in expected schema");return i.data},enabled:!!n,staleTime:1e3*60,retry:(s,i)=>!i.message.includes("Unauthorized")})};var ie={exports:{}};ie.exports;var _t;function Is(){return _t||(_t=1,function(r,n){var s=200,i="__lodash_hash_undefined__",a=1,u=2,h=9007199254740991,p="[object Arguments]",y="[object Array]",x="[object AsyncFunction]",m="[object Boolean]",S="[object Date]",j="[object Error]",D="[object Function]",q="[object GeneratorFunction]",R="[object Map]",k="[object Number]",ue="[object Null]",P="[object Object]",H="[object Promise]",Y="[object Proxy]",ee="[object RegExp]",E="[object Set]",L="[object String]",le="[object Symbol]",zt="[object Undefined]",Ne="[object WeakMap]",He="[object ArrayBuffer]",de="[object DataView]",Ft="[object Float32Array]",Bt="[object Float64Array]",$t="[object Int8Array]",qt="[object Int16Array]",Ut="[object Int32Array]",Gt="[object Uint8Array]",Vt="[object Uint8ClampedArray]",kt="[object Uint16Array]",Ht="[object Uint32Array]",Kt=/[\\^$.*+?()[\]{}|]/g,Wt=/^\[object .+?Constructor\]$/,Jt=/^(?:0|[1-9]\d*)$/,v={};v[Ft]=v[Bt]=v[$t]=v[qt]=v[Ut]=v[Gt]=v[Vt]=v[kt]=v[Ht]=!0,v[p]=v[y]=v[He]=v[m]=v[de]=v[S]=v[j]=v[D]=v[R]=v[k]=v[P]=v[ee]=v[E]=v[L]=v[Ne]=!1;var Ke=typeof xe=="object"&&xe&&xe.Object===Object&&xe,Qt=typeof self=="object"&&self&&self.Object===Object&&self,z=Ke||Qt||Function("return this")(),We=n&&!n.nodeType&&n,Je=We&&!0&&r&&!r.nodeType&&r,Qe=Je&&Je.exports===We,Ae=Qe&&Ke.process,Xe=function(){try{return Ae&&Ae.binding&&Ae.binding("util")}catch{}}(),Ye=Xe&&Xe.isTypedArray;function Xt(e,t){for(var o=-1,l=e==null?0:e.length,g=0,f=[];++o<l;){var _=e[o];t(_,o,e)&&(f[g++]=_)}return f}function Yt(e,t){for(var o=-1,l=t.length,g=e.length;++o<l;)e[g+o]=t[o];return e}function Zt(e,t){for(var o=-1,l=e==null?0:e.length;++o<l;)if(t(e[o],o,e))return!0;return!1}function en(e,t){for(var o=-1,l=Array(e);++o<e;)l[o]=t(o);return l}function tn(e){return function(t){return e(t)}}function nn(e,t){return e.has(t)}function rn(e,t){return e?.[t]}function sn(e){var t=-1,o=Array(e.size);return e.forEach(function(l,g){o[++t]=[g,l]}),o}function an(e,t){return function(o){return e(t(o))}}function on(e){var t=-1,o=Array(e.size);return e.forEach(function(l){o[++t]=l}),o}var cn=Array.prototype,un=Function.prototype,fe=Object.prototype,Ie=z["__core-js_shared__"],Ze=un.toString,O=fe.hasOwnProperty,et=function(){var e=/[^.]+$/.exec(Ie&&Ie.keys&&Ie.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),tt=fe.toString,ln=RegExp("^"+Ze.call(O).replace(Kt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nt=Qe?z.Buffer:void 0,he=z.Symbol,rt=z.Uint8Array,st=fe.propertyIsEnumerable,dn=cn.splice,K=he?he.toStringTag:void 0,it=Object.getOwnPropertySymbols,fn=nt?nt.isBuffer:void 0,hn=an(Object.keys,Object),Re=Z(z,"DataView"),te=Z(z,"Map"),Me=Z(z,"Promise"),De=Z(z,"Set"),Oe=Z(z,"WeakMap"),ne=Z(Object,"create"),pn=Q(Re),mn=Q(te),vn=Q(Me),gn=Q(De),yn=Q(Oe),at=he?he.prototype:void 0,Pe=at?at.valueOf:void 0;function W(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var l=e[t];this.set(l[0],l[1])}}function bn(){this.__data__=ne?ne(null):{},this.size=0}function xn(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function _n(e){var t=this.__data__;if(ne){var o=t[e];return o===i?void 0:o}return O.call(t,e)?t[e]:void 0}function Sn(e){var t=this.__data__;return ne?t[e]!==void 0:O.call(t,e)}function Tn(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=ne&&t===void 0?i:t,this}W.prototype.clear=bn,W.prototype.delete=xn,W.prototype.get=_n,W.prototype.has=Sn,W.prototype.set=Tn;function F(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var l=e[t];this.set(l[0],l[1])}}function wn(){this.__data__=[],this.size=0}function Cn(e){var t=this.__data__,o=me(t,e);if(o<0)return!1;var l=t.length-1;return o==l?t.pop():dn.call(t,o,1),--this.size,!0}function jn(e){var t=this.__data__,o=me(t,e);return o<0?void 0:t[o][1]}function En(e){return me(this.__data__,e)>-1}function Nn(e,t){var o=this.__data__,l=me(o,e);return l<0?(++this.size,o.push([e,t])):o[l][1]=t,this}F.prototype.clear=wn,F.prototype.delete=Cn,F.prototype.get=jn,F.prototype.has=En,F.prototype.set=Nn;function J(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var l=e[t];this.set(l[0],l[1])}}function An(){this.size=0,this.__data__={hash:new W,map:new(te||F),string:new W}}function In(e){var t=ve(this,e).delete(e);return this.size-=t?1:0,t}function Rn(e){return ve(this,e).get(e)}function Mn(e){return ve(this,e).has(e)}function Dn(e,t){var o=ve(this,e),l=o.size;return o.set(e,t),this.size+=o.size==l?0:1,this}J.prototype.clear=An,J.prototype.delete=In,J.prototype.get=Rn,J.prototype.has=Mn,J.prototype.set=Dn;function pe(e){var t=-1,o=e==null?0:e.length;for(this.__data__=new J;++t<o;)this.add(e[t])}function On(e){return this.__data__.set(e,i),this}function Pn(e){return this.__data__.has(e)}pe.prototype.add=pe.prototype.push=On,pe.prototype.has=Pn;function U(e){var t=this.__data__=new F(e);this.size=t.size}function Ln(){this.__data__=new F,this.size=0}function zn(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}function Fn(e){return this.__data__.get(e)}function Bn(e){return this.__data__.has(e)}function $n(e,t){var o=this.__data__;if(o instanceof F){var l=o.__data__;if(!te||l.length<s-1)return l.push([e,t]),this.size=++o.size,this;o=this.__data__=new J(l)}return o.set(e,t),this.size=o.size,this}U.prototype.clear=Ln,U.prototype.delete=zn,U.prototype.get=Fn,U.prototype.has=Bn,U.prototype.set=$n;function qn(e,t){var o=ge(e),l=!o&&nr(e),g=!o&&!l&&Le(e),f=!o&&!l&&!g&&mt(e),_=o||l||g||f,T=_?en(e.length,String):[],w=T.length;for(var b in e)O.call(e,b)&&!(_&&(b=="length"||g&&(b=="offset"||b=="parent")||f&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||Xn(b,w)))&&T.push(b);return T}function me(e,t){for(var o=e.length;o--;)if(dt(e[o][0],t))return o;return-1}function Un(e,t,o){var l=t(e);return ge(e)?l:Yt(l,o(e))}function re(e){return e==null?e===void 0?zt:ue:K&&K in Object(e)?Jn(e):tr(e)}function ot(e){return se(e)&&re(e)==p}function ct(e,t,o,l,g){return e===t?!0:e==null||t==null||!se(e)&&!se(t)?e!==e&&t!==t:Gn(e,t,o,l,ct,g)}function Gn(e,t,o,l,g,f){var _=ge(e),T=ge(t),w=_?y:G(e),b=T?y:G(t);w=w==p?P:w,b=b==p?P:b;var N=w==P,M=b==P,C=w==b;if(C&&Le(e)){if(!Le(t))return!1;_=!0,N=!1}if(C&&!N)return f||(f=new U),_||mt(e)?ut(e,t,o,l,g,f):Kn(e,t,w,o,l,g,f);if(!(o&a)){var A=N&&O.call(e,"__wrapped__"),I=M&&O.call(t,"__wrapped__");if(A||I){var V=A?e.value():e,B=I?t.value():t;return f||(f=new U),g(V,B,o,l,f)}}return C?(f||(f=new U),Wn(e,t,o,l,g,f)):!1}function Vn(e){if(!pt(e)||Zn(e))return!1;var t=ft(e)?ln:Wt;return t.test(Q(e))}function kn(e){return se(e)&&ht(e.length)&&!!v[re(e)]}function Hn(e){if(!er(e))return hn(e);var t=[];for(var o in Object(e))O.call(e,o)&&o!="constructor"&&t.push(o);return t}function ut(e,t,o,l,g,f){var _=o&a,T=e.length,w=t.length;if(T!=w&&!(_&&w>T))return!1;var b=f.get(e);if(b&&f.get(t))return b==t;var N=-1,M=!0,C=o&u?new pe:void 0;for(f.set(e,t),f.set(t,e);++N<T;){var A=e[N],I=t[N];if(l)var V=_?l(I,A,N,t,e,f):l(A,I,N,e,t,f);if(V!==void 0){if(V)continue;M=!1;break}if(C){if(!Zt(t,function(B,X){if(!nn(C,X)&&(A===B||g(A,B,o,l,f)))return C.push(X)})){M=!1;break}}else if(!(A===I||g(A,I,o,l,f))){M=!1;break}}return f.delete(e),f.delete(t),M}function Kn(e,t,o,l,g,f,_){switch(o){case de:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case He:return!(e.byteLength!=t.byteLength||!f(new rt(e),new rt(t)));case m:case S:case k:return dt(+e,+t);case j:return e.name==t.name&&e.message==t.message;case ee:case L:return e==t+"";case R:var T=sn;case E:var w=l&a;if(T||(T=on),e.size!=t.size&&!w)return!1;var b=_.get(e);if(b)return b==t;l|=u,_.set(e,t);var N=ut(T(e),T(t),l,g,f,_);return _.delete(e),N;case le:if(Pe)return Pe.call(e)==Pe.call(t)}return!1}function Wn(e,t,o,l,g,f){var _=o&a,T=lt(e),w=T.length,b=lt(t),N=b.length;if(w!=N&&!_)return!1;for(var M=w;M--;){var C=T[M];if(!(_?C in t:O.call(t,C)))return!1}var A=f.get(e);if(A&&f.get(t))return A==t;var I=!0;f.set(e,t),f.set(t,e);for(var V=_;++M<w;){C=T[M];var B=e[C],X=t[C];if(l)var vt=_?l(X,B,C,t,e,f):l(B,X,C,e,t,f);if(!(vt===void 0?B===X||g(B,X,o,l,f):vt)){I=!1;break}V||(V=C=="constructor")}if(I&&!V){var ye=e.constructor,be=t.constructor;ye!=be&&"constructor"in e&&"constructor"in t&&!(typeof ye=="function"&&ye instanceof ye&&typeof be=="function"&&be instanceof be)&&(I=!1)}return f.delete(e),f.delete(t),I}function lt(e){return Un(e,ir,Qn)}function ve(e,t){var o=e.__data__;return Yn(t)?o[typeof t=="string"?"string":"hash"]:o.map}function Z(e,t){var o=rn(e,t);return Vn(o)?o:void 0}function Jn(e){var t=O.call(e,K),o=e[K];try{e[K]=void 0;var l=!0}catch{}var g=tt.call(e);return l&&(t?e[K]=o:delete e[K]),g}var Qn=it?function(e){return e==null?[]:(e=Object(e),Xt(it(e),function(t){return st.call(e,t)}))}:ar,G=re;(Re&&G(new Re(new ArrayBuffer(1)))!=de||te&&G(new te)!=R||Me&&G(Me.resolve())!=H||De&&G(new De)!=E||Oe&&G(new Oe)!=Ne)&&(G=function(e){var t=re(e),o=t==P?e.constructor:void 0,l=o?Q(o):"";if(l)switch(l){case pn:return de;case mn:return R;case vn:return H;case gn:return E;case yn:return Ne}return t});function Xn(e,t){return t=t??h,!!t&&(typeof e=="number"||Jt.test(e))&&e>-1&&e%1==0&&e<t}function Yn(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Zn(e){return!!et&&et in e}function er(e){var t=e&&e.constructor,o=typeof t=="function"&&t.prototype||fe;return e===o}function tr(e){return tt.call(e)}function Q(e){if(e!=null){try{return Ze.call(e)}catch{}try{return e+""}catch{}}return""}function dt(e,t){return e===t||e!==e&&t!==t}var nr=ot(function(){return arguments}())?ot:function(e){return se(e)&&O.call(e,"callee")&&!st.call(e,"callee")},ge=Array.isArray;function rr(e){return e!=null&&ht(e.length)&&!ft(e)}var Le=fn||or;function sr(e,t){return ct(e,t)}function ft(e){if(!pt(e))return!1;var t=re(e);return t==D||t==q||t==x||t==Y}function ht(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=h}function pt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function se(e){return e!=null&&typeof e=="object"}var mt=Ye?tn(Ye):kn;function ir(e){return rr(e)?qn(e):Hn(e)}function ar(){return[]}function or(){return!1}r.exports=sr}(ie,ie.exports)),ie.exports}var Rs=Is();const Ms=St(Rs),Ds=r=>{const{accessToken:n}=wt(),{selectedNoteId:s}=oe(),{data:i}=ke(),{getLocalSync:a,localSyncStatus:u}=Ve(r),h=gr(),[p,y]=d.useState("upToDate");d.useEffect(()=>{if(!r||!s||!n)return;const m=()=>{const S="https://linaform-server.onrender.com";try{const j=r.getJSON(),D=new Blob([JSON.stringify({note:{id:s,content:j},accessToken:n})],{type:"application/json"});navigator.sendBeacon(S+"/api/note/autosave",D)}catch{console.error("Failed to send autosave request")}};return window.addEventListener("beforeunload",m),()=>window.removeEventListener("beforeunload",m)},[r,s,n]),d.useEffect(()=>{const m=a();if(!(!i||!m))try{y(Ms(m,i.content)?"upToDate":"behind")}catch{y("behind")}},[i,s,a]);const x=()=>{p!="loading"&&i&&(y("loading"),h.mutate({id:i.id,title:i.title,content:r?.getJSON()??{type:"doc",content:[{type:"paragraph"}]}}))};return d.useEffect(()=>{h.status==="success"&&y("upToDate"),h.status==="error"&&y("error")},[h.status]),d.useEffect(()=>{(u==="saving"||u==="saved")&&y(m=>m==="upToDate"?"behind":m)},[u,y]),{serverSyncStatus:p,setServerSyncStatus:y,syncToServer:x}};function Os({editor:r}){const{data:n}=ke(),{localSyncStatus:s}=Ve(r),{serverSyncStatus:i,syncToServer:a}=Ds(r);return n&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"w-36 flex items-baseline gap-0",children:[c.jsxs(_e,{children:[c.jsx(Se,{asChild:!0,children:c.jsx(Fe,{variant:"ghost",className:"size-7",disabled:!r.can().undo(),onClick:()=>r.commands.undo(),children:c.jsx(Jr,{})})}),c.jsx(Te,{children:c.jsx("p",{children:"Undo last action"})})]}),c.jsxs(_e,{children:[c.jsx(Se,{asChild:!0,children:c.jsx(Fe,{variant:"ghost",className:"size-7",disabled:!r.can().redo(),onClick:()=>r.commands.redo(),children:c.jsx(kr,{})})}),c.jsx(Te,{children:c.jsx("p",{children:"Redo last action"})})]}),c.jsxs(_e,{children:[c.jsx(Se,{asChild:!0,children:c.jsxs("div",{className:"w-22 mx-0 text-center",children:[s==="saving"&&c.jsx("p",{className:"text-sm text-yellow-500",children:"Saving"}),s==="saved"&&c.jsx("p",{className:"text-sm text-green-500",children:"Saved"}),s==="idle"&&c.jsx("p",{className:"text-sm text-gray-500",children:"Idle"})]})}),c.jsxs(Te,{children:[s==="saving"&&c.jsx("p",{children:"Saving to local backup..."}),s==="saved"&&c.jsx("p",{children:"Saved locally"}),s==="idle"&&c.jsx("p",{children:"No changes yet"})]})]}),c.jsxs(_e,{children:[c.jsx(Se,{asChild:!0,children:c.jsx(Fe,{"aria-label":"Sync Note with Server",variant:"ghost",onClick:a,children:i=="behind"?c.jsx(Gr,{className:"text-gray-500"}):i=="upToDate"?c.jsx(_r,{className:"text-emerald-500"}):i=="loading"?c.jsx(Sr,{className:"text-blue-500 animate-spin"}):c.jsx(qr,{className:"text-red-500"})})}),c.jsx(Te,{children:i=="behind"?c.jsx("p",{children:"Sync changes to server"}):i=="upToDate"?c.jsx("p",{children:"Up to date with server"}):i=="loading"?c.jsx("p",{children:"Syncing changes to server..."}):c.jsx("p",{children:"Sync failed"})})]})]}),c.jsxs("div",{className:"md:w-full flex items-end flex-col ",children:[c.jsx("p",{className:" md:text-2xl w-auto text-nowrap max-w-full text-ellipsis",children:n.title}),c.jsx("p",{className:"md:hidden block text-xs text-muted-foreground",children:n.createdAt.toLocaleDateString("GB",{day:"2-digit",month:"short",year:"numeric"})}),c.jsxs("p",{className:"text-muted-foreground text-xs md:block hidden",children:["created:",c.jsx("span",{className:"ml-2",children:n.createdAt.toLocaleDateString(void 0,{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"short",hour12:!1})})]}),c.jsxs("p",{className:"text-muted-foreground text-xs md:block hidden",children:["updated:",c.jsx("span",{className:"ml-2",children:n.updatedAt.toLocaleDateString(void 0,{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"short",hour12:!1})})]})]})]})}const Ps=$.memo(Os);function Ls({children:r}){return c.jsx(d.Suspense,{fallback:c.jsxs("div",{className:"w-full h-8 flex gap-4",children:[c.jsx(we,{children:c.jsx("div",{className:"w-16 h-full rounded-lg"})}),c.jsx(we,{children:c.jsx("div",{className:"w-10 h-full rounded-lg"})}),c.jsx(we,{children:c.jsx("div",{className:"w-12 h-full rounded-lg"})}),c.jsx(we,{children:c.jsx("div",{className:"w-14 h-full rounded-lg"})})]}),children:r})}const zs=d.lazy(()=>ae(()=>import("./file-DUSCBxGv.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),Fs=d.lazy(()=>ae(()=>import("./text-CI7k394y.js"),__vite__mapDeps([24,1,2,25,5,6,3,7,8]))),Bs=d.lazy(()=>ae(()=>import("./font-Dioqu7Te.js"),__vite__mapDeps([26,1,2]))),$s=d.lazy(()=>ae(()=>import("./structure-VTw6waI0.js"),__vite__mapDeps([27,1,2,28,5,6,3,7,8,25,4,9,10,11,12]))),qs=d.lazy(()=>ae(()=>import("./insert-h76UoTLW.js"),__vite__mapDeps([29,1,2,25,5,6,3,7,8])));function Us({editor:r}){const{selectedNoteId:n}=oe(),s=d.useMemo(()=>[{value:"file",Component:zs,label:"File"},{value:"text",Component:Fs,label:"Text"},{value:"font",Component:Bs,label:"Font"},{value:"structure",Component:$s,label:"Structure"},{value:"insert",Component:qs,label:"Insert"}],[]),[i,a]=d.useState("text"),u=d.useMemo(()=>s.find(p=>p.value===i)?.Component,[s,i]),h=Tr.create(Es);return n?c.jsxs("div",{className:"flex bg-background sticky top-0 z-20 w-full flex-wrap-reverse md:flex-nowrap md:justify-between items-baseline shadow-xs p-1 md:px-4",children:[c.jsxs(ws,{className:"max-w-74 min-w-74 h-18 overflow-x-visible",value:i,onValueChange:p=>a(p),children:[c.jsxs(Cs,{className:"bg-transparent *:data-[state=active]:border-b-primary *:border-transparent *:data-[state=active]:shadow-none *:rounded-none -mt-1 *:h-5",children:[c.jsx(gt,{}),s.map(p=>c.jsx(js,{value:p.value,children:p.label},p.value))]}),c.jsx(yr,{children:u&&r&&c.jsx(h,{className:"flex gap-2 ml-8 md:ml-0  items-start *:h-8",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.2},value:i,children:c.jsx(Ls,{children:c.jsx(u,{editor:r})})},i)})]}),r&&c.jsx(Ps,{editor:r})]}):c.jsx(gt,{className:"top-0 absolute"})}const Gs=$.memo(Us);function Vs({editor:r}){const{data:n,isLoading:s,isError:i}=ke(),{getLocalSync:a}=Ve(r),{syncFonts:u}=jr(),{theme:h}=Fr();return d.useEffect(()=>{n&&u(n.content)},[u,n]),d.useEffect(()=>{if(r&&n){const p=n.content||{type:"doc",content:[{type:"paragraph",content:[]}]},y=a();y?r.commands.setContent(y):p&&r.commands.setContent(p)}},[n,r,a]),d.useEffect(()=>{if(!r||!n)return;const p=Er(r.getJSON(),h=="dark");r.commands.setContent(p)},[h,r,n]),d.useEffect(()=>{r&&r.setEditable(n!=null)},[n,r]),i?c.jsx("div",{children:"Error"}):r&&n&&c.jsx(Br,{isLoading:s,children:c.jsx("div",{className:"min-h-[85vh] relative bg-card min-w-2/3 max-w-[75vw] overflow-x-hidden self-center px-6 py-4 my-2 shadow-2xl cursor-text",onClick:()=>r?.chain().focus().run(),children:c.jsx(os,{editor:r,className:`\r
  [&_.ProseMirror]:focus:outline-none\r
  [&_.ProseMirror]:text-base\r
  [&_.ProseMirror]:text-primary\r
  [&_.ProseMirror]:leading-relaxed\r
  [&_.ProseMirror]:min-h-[80vh]\r
  [&_.ProseMirror]:whitespace-pre-wrap\r
`})})})}function ks(){const{selectedNoteId:r}=oe(),n=ps({editable:!!r,extensions:[Nr,Ar,Ir.configure({types:["heading","paragraph"]}),Rr,Mr,Dr,Or,Pr,Lr,zr]});return n&&c.jsxs(c.Fragment,{children:[c.jsxs("main",{className:"flex flex-col",children:[c.jsx(Gs,{editor:n}),c.jsx(Vs,{editor:n})]}),!r&&c.jsxs("div",{className:"text-muted-foreground flex flex-col items-center justify-center h-full gap-4",children:[c.jsx(Kr,{size:44}),"No note is selected to open"]})]})}const oi=Object.freeze(Object.defineProperty({__proto__:null,default:ks},Symbol.toStringTag,{value:"Module"}));export{oi as i,ke as u};
